{% if sections %}
  <ul class="list-group">
    {% for section in sections %}
    <li class="list-group-item d-flex justify-content-between align-items-start">
      <div class="ms-2 me-auto">
        <div class="fw-bold">{{ section.title }} <span class="badge bg-info text-dark ms-2">{{ section.type|capitalize }}</span></div>
        {% if section.type == 'text' or not section.type %}
          <div>{{ section.content }}</div>
        {% elif section.type == 'file' and section.file_url %}
          <a href="{{ section.file_url }}" target="_blank">Download File</a>
        {% elif section.type == 'assignment' %}
          <div>{{ section.content }}</div>
          {% if section.assignment_due %}<div class="text-danger small">Due: {{ section.assignment_due.strftime('%Y-%m-%d %H:%M') }}</div>{% endif %}
        {% elif section.type == 'note' %}
          <div class="text-muted">{{ section.content }}</div>
        {% endif %}
      </div>
      <div class="d-flex flex-column gap-1">
        <button class="btn btn-sm btn-outline-warning" onclick="loadPage('class/{{ lesson.id }}/sections/{{ section.id }}/edit')">Edit</button>
        <button class="btn btn-sm btn-outline-danger" onclick="deleteSection('{{ lesson.id }}','{{ section.id }}')">Delete</button>
      </div>
    </li>
    {% endfor %}
  </ul>
{% else %}
  <div class="text-muted">No content yet. Click + Add Content to start.</div>
{% endif %}
<script>
function deleteSection(lessonId, sectionId) {
  if (!confirm('Delete this content?')) return;
  fetch(`/partial/class/${lessonId}/sections/${sectionId}/delete`, {
    method: 'POST',
    headers: {
      'X-Requested-With': 'XMLHttpRequest',
      'Accept': 'application/json'
    }
  })
  .then(r => r.json())
  .then(data => {
    if (data.success) {
      loadLessonSections();
    } else {
      alert(data.message || 'Error deleting content.');
    }
  });
}
</script> 